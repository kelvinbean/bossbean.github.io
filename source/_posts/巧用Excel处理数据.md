---
title: 做个“懒惰”的工程师
---

其实我还挺欣赏懒惰的程序员的，当然不是说懒惰就是不做事，而是他们为了减少麻烦，会去思考怎么做才能减少这些重复的人为操作，从而制定出非常多为其他开发者带来便利的东西。

今天讲的当然没有很宏观的东西，只是一个很小的事情。

严格意义来说，这篇文章跟前端没什么太大关系。但是我觉得却很有用。

excel表格很多人都用过，但是却不是所有人都知道它还有非常多的其他的用途。

今天我就来讲它的一个很简单的用途。就是把word的提供的数据，转变成想要的数组格式。

<!-- More -->

### 举个栗子

最近项目中，产品经理丢给我一个数据，是国家和区号的一一对应的。


    埃及   +20
    奥地利 +43
    阿根廷 +54
    澳大利亚 +61
    阿富汗 +93
    阿尔及利亚 +213
    安哥拉 +244
    阿森松 +247
    埃塞俄比亚 +251
    爱尔兰 +353
    阿尔巴尼亚 +355
    爱沙尼亚 +372
    安道尔共和国 +376
    澳门 +853
    阿曼 +968
    ...


然而我项目中需要把他给我的这个word文档的内容转成

```bash
[{
    name:"埃及",
    value:"+20"
},...]
```

然而数据之多，处理起来真的很烦。那怎么办呢？我们可以用excel来解决。

### excel的巧用

首先先把word的数据复制到excel上。粘贴选项选择匹配目标格式。

![image text](/images/img/excel1.png)

然后分列，由于我这个数据是文字中间是空格做间隙的。所以分列的时候勾上空格，需要注意的是我这里要因为有个+号，所以要设置第二列为文本格式，不然+号就没了。

![image text](/images/img/excel2.gif)

第三步就是添加列，给需要添加文字的位置插入列

![image text](/images/img/excel3.gif)

下一步就是在列里面填入所需的格式内容。这里注意，单元格的首字符是单引号的时候这个单引号会隐藏，所以这里C列和E列开始我都是敲的是两个单引号。

![image text](/images/img/excel4.gif)

然后，我们在对excel需要换行的地方输入换行符。excel的换行符是alt+enter键。然后双击右下角，让每一列都引入数据。

![image text](/images/img/excel5.gif)

最后在数据再数据列后面随意选一列来写下表达式。如下图。输完后按enter键。然后再双击生成出所有的数据

![image text](/images/img/excel6.gif)

就这样。这个数据就获取到了，然后再复制出来。放到word里，直接复制到sublime，可能会有格式问题。

![image text](/images/img/excel7.gif)

最后复制到sublime,然后alt+F3选中全部，加tab就获取到一个你要的格式的数组了。

![image text](/images/img/excel8.gif)

好了，大功告成！